<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.4.3.final using JasperReports Library version 6.4.3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Metas" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="4bdf33d4-8f50-4f98-bcf6-3e335fb31299">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="SiproMDB"/>
	<subDataset name="Dataset1" uuid="1a32e70a-2b29-4554-8a5b-56c8c1e90c4c">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="SiproMDB"/>
		<parameter name="metaid" class="java.lang.String">
			<defaultValueExpression><![CDATA[$F{id}]]></defaultValueExpression>
		</parameter>
		<queryString language="SQL">
			<![CDATA[select valores.ejercicio, SUM(eneroP) eneroP, SUM(eneroR) eneroR, SUM(febreroP) febreroP, SUM(febreroR) febreroR,
SUM(marzoP) marzoP, SUM(marzoR) marzoR, SUM(abrilP) abrilP, SUM(abrilR) abrilR, SUM(mayoP) mayoP, SUM(mayoR) mayoR, SUM(junioP) junioP, SUM(junioR) junioR,
SUM(julioP) julioP, SUM(julioR) julioR, SUM(agostoP) agostoP, SUM(agostoR) agostoR, SUM(septiembreP) septiembreP, SUM(septiembreR) septiembreR, 
SUM(octubreP) octubreP, SUM(octubreR) octubreR, SUM(noviembreP) noviembreP, SUM(noviembreR) noviembreR, SUM(diciembreP) diciembreP, SUM(diciembreR) diciembreR 
from
(select mp.metaid, ejercicio,
CASE  WHEN m.dato_tipoid = 2 THEN mp.enero_entero
WHEN m.dato_tipoid = 3 THEN mp.enero_decimal  END eneroP,
CASE WHEN m.dato_tipoid = 2 THEN mp.febrero_entero
WHEN m.dato_tipoid = 3 THEN mp.febrero_decimal END febreroP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.marzo_entero
WHEN m.dato_tipoid = 3 THEN mp.marzo_decimal  END marzoP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.abril_entero
WHEN m.dato_tipoid = 3 THEN mp.abril_decimal  END abrilP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.mayo_entero
WHEN m.dato_tipoid = 3 THEN mp.mayo_decimal  END mayoP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.junio_entero
WHEN m.dato_tipoid = 3 THEN mp.junio_decimal  END junioP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.julio_entero
WHEN m.dato_tipoid = 3 THEN mp.julio_decimal  END julioP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.agosto_entero
WHEN m.dato_tipoid = 3 THEN mp.agosto_decimal  END agostoP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.septiembre_entero
WHEN m.dato_tipoid = 3 THEN mp.septiembre_decimal  END septiembreP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.octubre_entero
WHEN m.dato_tipoid = 3 THEN mp.octubre_decimal  END octubreP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.noviembre_entero
WHEN m.dato_tipoid = 3 THEN mp.noviembre_decimal  END noviembreP ,
CASE WHEN m.dato_tipoid = 2 THEN mp.diciembre_entero
WHEN m.dato_tipoid = 3 THEN mp.diciembre_decimal  END diciembreP ,
0 eneroR, 0 febreroR, 0 marzoR, 0 abrilR, 0 mayoR, 0 junioR, 0 julioR, 0 agostoR, 0 septiembreR, 0 octubreR, 0 noviembreR, 0 diciembreR
from meta_planificado mp
join meta m on mp.metaid = m.id
where metaid =  $P{metaid} 
and ejercicio = YEAR(now())
union
select t1.metaid, t1.anio ejercicio,
0 eneroP, 0 febreroP, 0 marzoP, 0 abrilP, 0 mayoP, 0 junioP, 0 julioP, 0 agostoP, 0 septiembreP, 0 octubreP, 0 noviembreP, 0 diciembreP,
SUM(case when t1.mes = 1 then t1.valor end) eneroR,
SUM(case when t1.mes = 2 then t1.valor end) febreroR, 
SUM(case when t1.mes = 3 then t1.valor end) marzoR,
SUM(case when t1.mes = 4 then t1.valor end) abrilR,
SUM(case when t1.mes = 5 then t1.valor end) mayoR,
SUM(case when t1.mes = 6 then t1.valor end) junioR,
SUM(case when t1.mes = 7 then t1.valor end) julioR,
SUM(case when t1.mes = 8 then t1.valor end) agostoR,
SUM(case when t1.mes = 9 then t1.valor end) septiembreR,
SUM(case when t1.mes = 10 then t1.valor end) octubreR,
SUM(case when t1.mes = 11 then t1.valor end) noviembreR, 
SUM(case when t1.mes = 12 then t1.valor end) diciembreR
from (
select ma.metaid, YEAR(ma.fecha) anio, MONTH(ma.fecha) mes,
CASE
WHEN m.dato_tipoid = 2 THEN ma.valor_entero
WHEN m.dato_tipoid = 3 THEN ma.valor_decimal
END valor
from meta_avance ma
join meta m on ma.metaid = m.id
where ma.metaid = $P{metaid} 
and ma.estado = 1
and YEAR(ma.fecha) = YEAR(now())
) t1
) valores

]]>
		</queryString>
		<field name="ejercicio" class="java.lang.Long">
			<property name="com.jaspersoft.studio.field.label" value="ejercicio"/>
		</field>
		<field name="eneroP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="eneroP"/>
		</field>
		<field name="eneroR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="eneroR"/>
		</field>
		<field name="febreroP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="febreroP"/>
		</field>
		<field name="febreroR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="febreroR"/>
		</field>
		<field name="marzoP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="marzoP"/>
		</field>
		<field name="marzoR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="marzoR"/>
		</field>
		<field name="abrilP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="abrilP"/>
		</field>
		<field name="abrilR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="abrilR"/>
		</field>
		<field name="mayoP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="mayoP"/>
		</field>
		<field name="mayoR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="mayoR"/>
		</field>
		<field name="junioP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="junioP"/>
		</field>
		<field name="junioR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="junioR"/>
		</field>
		<field name="julioP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="julioP"/>
		</field>
		<field name="julioR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="julioR"/>
		</field>
		<field name="agostoP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="agostoP"/>
		</field>
		<field name="agostoR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="agostoR"/>
		</field>
		<field name="septiembreP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="septiembreP"/>
		</field>
		<field name="septiembreR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="septiembreR"/>
		</field>
		<field name="octubreP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="octubreP"/>
		</field>
		<field name="octubreR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="octubreR"/>
		</field>
		<field name="noviembreP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="noviembreP"/>
		</field>
		<field name="noviembreR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="noviembreR"/>
		</field>
		<field name="diciembreP" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="diciembreP"/>
		</field>
		<field name="diciembreR" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="diciembreR"/>
		</field>
		<variable name="Variable_1" class="java.lang.String" resetType="Column">
			<variableExpression><![CDATA[$F{id}]]></variableExpression>
		</variable>
	</subDataset>
	<parameter name="usuario" class="java.lang.String" isForPrompting="false"/>
	<parameter name="proyectoId" class="java.lang.Integer"/>
	<queryString language="SQL">
		<![CDATA[SELECT c.nombre componente, p.nombre producto, um.nombre unidadmedida, m.id, m.nombre meta, 
CASE WHEN m.dato_tipoid=1 THEN m.meta_final_string 
WHEN m.dato_tipoid=2 THEN m.meta_final_entero 
WHEN m.dato_tipoid=3 THEN m.meta_final_decimal 
WHEN m.dato_tipoid=4 THEN m.meta_final_fecha 
ELSE m.meta_final_entero END AS meta_final
FROM meta m
JOIN producto p ON m.objeto_id = p.id
JOIN componente c ON p.componenteid = c.id
JOIN proyecto py ON c.proyectoid = py.id
JOIN meta_unidad_medida um ON m.meta_unidad_medidaid = um.id
WHERE m.objeto_tipo=3 AND py.id = 1
AND m.estado=1 AND p.estado=1 AND c.estado=1 AND py.estado=1
UNION
SELECT c.nombre componente, p.nombre producto, um.nombre unidadmedida, m.id, m.nombre meta, 
CASE WHEN m.dato_tipoid=1 THEN m.meta_final_string 
WHEN m.dato_tipoid=2 THEN m.meta_final_entero 
WHEN m.dato_tipoid=3 THEN m.meta_final_decimal 
WHEN m.dato_tipoid=4 THEN m.meta_final_fecha 
ELSE m.meta_final_entero END AS meta_final
FROM meta m
JOIN producto p ON m.objeto_id = p.id
JOIN subcomponente sc ON p.subcomponenteid = sc.id
JOIN componente c ON sc.componenteid = c.id
JOIN proyecto py ON c.proyectoid = py.id
JOIN meta_unidad_medida um ON m.meta_unidad_medidaid = um.id
WHERE m.objeto_tipo=3 AND py.id = 1
AND m.estado=1 AND p.estado=1 AND sc.estado=1 AND c.estado=1 AND py.estado=1]]>
	</queryString>
	<field name="componente" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="componente"/>
	</field>
	<field name="producto" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="producto"/>
	</field>
	<field name="unidadmedida" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="unidadmedida"/>
	</field>
	<field name="id" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="id"/>
	</field>
	<field name="meta" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="meta"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="actividad"/>
	</field>
	<field name="meta_final" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="meta_final"/>
	</field>
	<group name="Group1">
		<groupExpression><![CDATA[$F{componente}]]></groupExpression>
		<groupHeader>
			<band height="30">
				<textField>
					<reportElement mode="Opaque" x="0" y="0" width="800" height="30" forecolor="#FCFAFA" backcolor="#424141" uuid="10b0f87f-e779-4e26-b187-38ed54063f38">
						<property name="com.jaspersoft.studio.unit.leftIndent" value="px"/>
					</reportElement>
					<box>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font isBold="true"/>
						<paragraph leftIndent="4"/>
					</textElement>
					<textFieldExpression><![CDATA["Componente: ".concat( $F{componente})]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="Group2">
		<groupExpression><![CDATA[$F{producto}]]></groupExpression>
		<groupHeader>
			<band height="30">
				<textField>
					<reportElement mode="Opaque" x="0" y="0" width="800" height="30" backcolor="#D6D4D4" uuid="027f21ea-c3d8-4b20-973e-1e0accfae0d0">
						<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="893fff96-e6c6-4357-b8e0-22b093e33f14"/>
						<property name="com.jaspersoft.studio.unit.width" value="px"/>
						<property name="com.jaspersoft.studio.unit.leftIndent" value="px"/>
					</reportElement>
					<box>
						<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font isBold="true"/>
						<paragraph leftIndent="4"/>
					</textElement>
					<textFieldExpression><![CDATA["Producto: ".concat( $F{producto})]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="75" splitType="Stretch">
			<staticText>
				<reportElement mode="Transparent" x="250" y="17" width="290" height="40" backcolor="#0D0D0D" uuid="f16d3680-349f-4247-a4ad-b7ebcf351e51"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Arial" size="25" isBold="false"/>
				</textElement>
				<text><![CDATA[Metas Año Fiscal]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="12" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="30" splitType="Stretch">
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="170" height="30" forecolor="#FFF7F7" backcolor="#C2BABA" uuid="62bcf306-f9a2-4697-9549-3928a13f9e53">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="893fff96-e6c6-4357-b8e0-22b093e33f14"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Meta]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="170" y="0" width="100" height="30" forecolor="#FFF7F7" backcolor="#C2BABA" uuid="77b27931-f627-4238-b9bf-903af5139e9f">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="52d2810b-d2fc-4eb0-8ea7-111afdcbdca5"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Unidad de Medida]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Opaque" x="700" y="0" width="100" height="30" forecolor="#FFF7F7" backcolor="#C2BABA" uuid="e02ec808-ded8-42f2-9fc1-74f61c460852">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="fc56ff1a-8aef-4d9a-80b3-5a6274ef885d"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Meta Final]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="54" splitType="Stretch">
			<textField>
				<reportElement x="170" y="0" width="100" height="30" uuid="6407573c-7e9c-4437-9dd9-af13ffdde8dc">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="52d2810b-d2fc-4eb0-8ea7-111afdcbdca5"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.leftIndent" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{unidadmedida}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="0" width="170" height="30" uuid="4dd43cd3-2a0e-4f03-b63c-5fb2f3bae734">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="62b6767f-7649-436d-8f36-c9bd077d8c6c"/>
					<property name="com.jaspersoft.studio.unit.leftIndent" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{meta}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="700" y="0" width="100" height="30" uuid="a60094ca-de40-4565-ad8f-23c099399e6a">
					<property name="com.jaspersoft.studio.spreadsheet.connectionID" value="3308b2af-1808-4c72-bd40-f01b4fa96bed"/>
					<property name="com.jaspersoft.studio.unit.leftIndent" value="px"/>
				</reportElement>
				<box>
					<topPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="1.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Middle">
					<paragraph leftIndent="4"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{meta_final}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="54" splitType="Stretch">
			<textField>
				<reportElement x="600" y="12" width="100" height="30" uuid="59b09d6d-2d31-4664-bd4e-481d9e6f8344"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Página " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="700" y="12" width="100" height="30" uuid="bd8f6e26-28ab-4f08-8690-a01558caf95e"/>
				<textElement textAlignment="Left"/>
				<textFieldExpression><![CDATA[" de " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="100" y="20" width="143" height="20" uuid="15ee841f-cefb-4d30-851b-12aa32c10599"/>
				<textFieldExpression><![CDATA[$P{usuario}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy hh:mm:ss a">
				<reportElement x="100" y="0" width="143" height="20" uuid="20fa378d-26de-43e3-b075-ea34a08437a0"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="20" width="100" height="20" uuid="44b378b9-98dc-4197-b418-1fe0031f4215"/>
				<text><![CDATA[Usuario:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="100" height="20" uuid="8d7b65f2-5d01-4653-90a1-f25e59e8aa4a"/>
				<text><![CDATA[Fecha generación:]]></text>
			</staticText>
		</band>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
